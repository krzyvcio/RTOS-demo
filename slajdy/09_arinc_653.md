# ARINC 653 - Standard Awioniczny

## Definicja

Standard avionics określający interfejs między systemem operacyjnym a aplikacjami w systemach lotniczych. Definiuje partycjonowanie czasowe i przestrzenne, komunikację między partycjami oraz harmonogramowanie.

______________________________________________________________________

## Architektura ARINC 653

```
┌───────────────────────────────────────────────────────────────┐
│                    ARINC 653 ARCHITECTURE                     │
├───────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                 APLIKACJE (Partycje)                     │ │
│  │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌──────────┐│ │
│  │  │Partycja 1 │ │Partycja 2 │ │Partycja 3 │ │Partycja 4││ │
│  │  │ Flight    │ │ Nav       │ │ Comm      │ │ IFE      ││ │
│  │  │ Control   │ │           │ │           │ │          ││ │
│  │  │ (DAL-A)   │ │ (DAL-B)   │ │ (DAL-C)   │ │ (DAL-E)  ││ │
│  │  └───────────┘ └───────────┘ └───────────┘ └──────────┘│ │
│  └─────────────────────────────────────────────────────────┘ │
│                           │                                   │
│                           ▼                                   │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │              APEX (APplication/EXecutive)                │ │
│  │  ┌─────────────────────────────────────────────────────┐│ │
│  │  │ API: Partycje, Porty, Zdrowie, Pamięć, Czas         ││ │
│  │  └─────────────────────────────────────────────────────┘│ │
│  └─────────────────────────────────────────────────────────┘ │
│                           │                                   │
│                           ▼                                   │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                 RTOS KERNEL                              │ │
│  │  ┌─────────────────────────────────────────────────────┐│ │
│  │  │ Partition Scheduler, Memory Protection, Health Mon. ││ │
│  │  └─────────────────────────────────────────────────────┘│ │
│  └─────────────────────────────────────────────────────────┘ │
│                           │                                   │
│                           ▼                                   │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                 HARDWARE                                 │ │
│  │  PowerPC, ARM, x86 (z MMU/MPU)                          │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

______________________________________________________________________

## Główne koncepcje

### Partycjonowanie

| Typ | Opis | Cel |
|-----|------|-----|
| **Temporal** | Izolacja czasowa między partycjami | Gwarantowany czas CPU |
| **Spatial** | Izolacja pamięci między partycjami | Ochrona pamięci |

### APEX API

| Usługa | Opis |
|--------|------|
| **Partition Management** | Tworzenie, start, stop partycji |
| **Process Management** | Zarządzanie procesami w partycji |
| **Time Management** | Czas, periody, deadlines |
| **Inter-Partition Communication** | Sampling, Queuing ports |
| **Intra-Partition Communication** | Buffers, Blackboards, Semaphores |
| **Health Monitoring** | Monitorowanie błędów |

______________________________________________________________________

## Use Cases (Zastosowania praktyczne)

### Samoloty cywilne

| Samolot | System ARINC 653 | Partycje |
|---------|------------------|----------|
| **Boeing 787** | VxWorks 653 | 50+ partycji |
| **Airbus A350** | INTEGRITY-178 | 40+ partycji |
| **Airbus A380** | VxWorks 653 | 30+ partycji |
| **Embraer E-Jets** | LynxOS-178 | 20+ partycji |

### Wojskowe

- **F-35 Lightning II** - PikeOS
- **F-22 Raptor** - INTEGRITY-178
- **Eurofighter Typhoon** - VxWorks 653

### Kosmiczne

- **ISS** - Systemy sterowania
- **Satelity** - Kontrola lotu, telemetria

______________________________________________________________________

## Harmonogram partycji (Maj Frame)

```
┌─────────────────────────────────────────────────────────────┐
│                    MAJOR FRAME EXAMPLE                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  MAJOR FRAME = 100ms                                        │
│                                                             │
│  ┌────────────────────────────────────────────────────────┐│
│  │0ms      20ms      40ms      60ms      80ms     100ms  ││
│  │├─────────┼─────────┼─────────┼─────────┼─────────┤     ││
│  ││         │         │         │         │         │     ││
│  ││ Partycja│ Partycja│ Partycja│ Partycja│  IDLE   │     ││
│  ││    A    │    B    │    C    │    D    │         │     ││
│  ││ Flight  │  Nav    │  Comm   │  Diag   │         │     ││
│  ││ Control │         │         │         │         │     ││
│  ││ (DAL-A) │ (DAL-B) │ (DAL-C) │ (DAL-D) │         │     ││
│  ││  20ms   │  20ms   │  20ms   │  20ms   │  20ms   │     ││
│  │└─────────┴─────────┴─────────┴─────────┴─────────┘     ││
│  └────────────────────────────────────────────────────────┘│
│                                                             │
│  Cykl powtarza się co 100ms (MAJOR FRAME)                  │
│                                                             │
│  GWARANCJE:                                                 │
│  ├── Partycja A ZAWSZE ma 20ms co 100ms                    │
│  ├── Partycja B nie może "ukraść" czasu Partycji A         │
│  └── Awaria Partycji D nie wpływa na A, B, C               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

______________________________________________________________________

## Komunikacja między partycjami

### Sampling Port

```
┌─────────────────────────────────────────────────────────────┐
│                    SAMPLING PORT                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Charakterystyka:                                           │
│  ├── Jedna wiadomość (ostatnia)                            │
│  ├── Bez kolejki                                            │
│  ├── Nadpisz przy nowej wiadomości                         │
│  └── Non-blocking                                           │
│                                                             │
│  Producer (Partycja A):                                     │
│  ┌──────────────┐                                           │
│  │ WRITE_PORT   │───────┐                                   │
│  └──────────────┘       │                                   │
│                         ▼                                   │
│                  ┌──────────────┐                           │
│                  │ SAMPLING     │ ← Ostatnia wartość       │
│                  │ PORT         │                           │
│                  └──────────────┘                           │
│                         │                                   │
│                         ▼                                   │
│  Consumer (Partycja B):                                     │
│  ┌──────────────┐                                           │
│  │ READ_PORT    │◄──────┘                                   │
│  └──────────────┘                                           │
│                                                             │
│  Zastosowanie:                                              │
│  ├── Stan sensorów (aktualna wartość)                      │
│  ├── Pozycja (lat, lon, alt)                               │
│  └── Status systemu                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Queuing Port

```
┌─────────────────────────────────────────────────────────────┐
│                    QUEUING PORT                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Charakterystyka:                                           │
│  ├── Kolejka FIFO (konfigurowalna głębokość)               │
│  ├── Może blokować gdy pełna/pusta                         │
│  ├── Zachowanie kolejności                                  │
│  └── Z gwarantowaną dostarczeniem                          │
│                                                             │
│  Producer (Partycja A):                                     │
│  ┌──────────────┐                                           │
│  │ SEND         │───────┐                                   │
│  └──────────────┘       │                                   │
│                         ▼                                   │
│                  ┌──────────────┐                           │
│                  │ QUEUING      │                           │
│                  │ PORT         │ ← [Msg1][Msg2][Msg3]...   │
│                  │ (FIFO Queue) │                           │
│                  └──────────────┘                           │
│                         │                                   │
│                         ▼                                   │
│  Consumer (Partycja B):                                     │
│  ┌──────────────┐                                           │
│  │ RECEIVE      │◄──────┘                                   │
│  └──────────────┘                                           │
│                                                             │
│  Zastosowanie:                                              │
│  ├── Komendy sterowania                                    │
│  ├── Logi zdarzeń                                           │
│  └── Wiadomości do przetworzenia                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

______________________________________________________________________

## Health Monitoring

```
┌─────────────────────────────────────────────────────────────┐
│                    HEALTH MONITORING                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  POZIOMY DETEKCJI BŁĘDÓW:                                   │
│                                                             │
│  1. MODULE LEVEL (procesor, pamięć)                        │
│     └── Reakcja: Reset systemu                              │
│                                                             │
│  2. PARTITION LEVEL (partycja)                             │
│     └── Reakcja: Restart partycji                          │
│                                                             │
│  3. PROCESS LEVEL (proces w partycji)                      │
│     └── Reakcja: Restart procesu, handler błędu            │
│                                                             │
│  TYPOWE BŁĘDY:                                              │
│  ├── Deadline miss                                          │
│  ├── Memory violation                                       │
│  ├── Stack overflow                                         │
│  ├── Arithmetic error                                       │
│  ├── Application error                                      │
│  └── Power failure                                          │
│                                                             │
│  HANDLERY:                                                  │
│  ├── Partition Handler (user-defined)                      │
│  ├── System Handler (system-defined)                       │
│  └── Recovery Actions: Ignore, Restart, Stop, Reset        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

______________________________________________________________________

## Zagrożenia

| Zagrożenie | Opis | Mitigacja |
|------------|------|-----------|
| **Overrun partycji** | Przekroczenie okna czasowego | Watchdog, partition reset |
| **Błędowa konfiguracja** | Złe okna czasowe | Walidacja, symulacja |
| **Inter-partition deadlock** | Zakleszczenie przez porty | Timeout, design patterns |
| **Memory fragmentation** | Fragmentacja w partycji | Static allocation |
| **Certification overhead** | Koszt certyfikacji | Reuse, DO-178C tools |

______________________________________________________________________

## Implementacje ARINC 653

| System | Producent | Platforma | Certyfikacja |
|--------|-----------|-----------|--------------|
| **VxWorks 653** | Wind River | PowerPC, ARM, x86 | DO-178C DAL-A |
| **INTEGRITY-178** | Green Hills | PowerPC, ARM | DO-178C DAL-A |
| **LynxOS-178** | Lynx Software | x86, PowerPC | DO-178C DAL-A |
| **PikeOS** | Sysgo | ARM, PowerPC | DO-178C, ISO 26262 |
| **Deos** | DDC-I | PowerPC, ARM | DO-178C DAL-A |

______________________________________________________________________

## Kierunki rozwoju

### 1. Multi-Core ARINC 653

- Partycje rozproszone na wiele rdzeni
- AMP (Asymmetric Multi-Processing)
- Nowe wyzwania dla certyfikacji

### 2. ARINC 653 Part 4 - Integrated Modular Avionics

- Wirtualizacja
- Dynamiczne partycje

### 3. Cyber Security

- ARINC 653 z security hardening
- Secure boot, encryption

______________________________________________________________________

## Zadanie praktyczne

```
ZADANIE:
Zaprojektuj system ARINC 653 dla lekkiego samolotu:

PARTYCJE:
├── Flight Control (DAL-A): okres 10ms, WCET 3ms
├── Navigation (DAL-B): okres 50ms, WCET 10ms
├── Communication (DAL-C): okres 100ms, WCET 20ms
└── Display (DAL-D): okres 100ms, WCET 30ms

PYTANIA:
1. Zaproponuj Major Frame
2. Zdefiniuj Sampling Ports dla nawigacji
3. Zdefiniuj Queuing Ports dla komunikacji
4. Jakie akcje Health Monitor dla każdego poziomu?

ROZWIĄZANIE:
1. Major Frame = 100ms (LCM okresów):
   [0-30ms]: Flight Control (x3 w ramach 100ms)
   [30-40ms]: Navigation (x2 w ramach 100ms)
   [40-60ms]: Communication
   [60-90ms]: Display
   [90-100ms]: Idle/Margin

2. Sampling Ports:
   - GPS_POSITION → Flight Control, Display
   - ATTITUDE → Flight Control, Display

3. Queuing Ports:
   - RADIO_MESSAGES → Communication (głębokość 10)
   - FLIGHT_COMMANDS → Flight Control (głębokość 5)

4. Health Monitor:
   - Process: Restart procesu, log błędu
   - Partition: Restart partycji, alarm
   - Module: System reset, backup system
```

______________________________________________________________________

## Pytania kontrolne

1. Czym się różni Sampling Port od Queuing Port?
1. Dlaczego partycjonowanie temporalne jest ważne dla bezpieczeństwa?
1. Jakie są zalety i wady statycznego harmonogramu partycji?
1. Jak ARINC 653 wspiera certyfikację DO-178C?

______________________________________________________________________

## Literatura

1. ARINC 653 Specification, "Avionics Application Software Standard Interface"
1. DO-178C, "Software Considerations in Airborne Systems"
1. Wind River, "VxWorks 653 Programmer's Guide"
1. Rushby, "Partitioning in Avionics Architectures"
